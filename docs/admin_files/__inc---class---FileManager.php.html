<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs for page FileManager.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="file-name">/_inc/class/FileManager.php</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
							<a href="#sec-classes">Classes</a>
			|													<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">File Manager Class, Furasta.Org</p>
<p class="description"><p>This is the Furasta.Org File Manager Class. It is intended to be used  to manage all of the writing to / reading from the user files  directory. The advantage of using this class over standard PHP functions  is that it accounts for all kinds of extra things like security, file  permissions (for furasta.org users, not system permissions) etc.</p><p>==== FILE PERMISSIONS ====</p><p>Furasta.Org file permissions work using two methods of approach:</p><p><ol><li>All users/groups have a file perm field in the database. This works
 	   along the same lines as the perm field in pages. This field
 	   is intended to overwrite the other file permissions and
	   consists of a list of users and groups who's files the user/group
	   can view/edit.</li><li>Each file has its own field in the database which states the name
 	   of the files, the type (dir or file), the permissions string for
	   who can view/edit it, the public status (whether its a publicly
	   viewable or private file) and the hash which is a unique md5 string
 	   which if the file is viewed in the browser by anyone, even if private,
 	   and this string is correctly added to the URL the file will be displayed.</li></ol></p><p>==== FILES DATABSE ====</p><p>The file manager class keeps a record of all files in the database.  The files are then named according to their unique identifier in the db,  that's how the class keeps track of the files database info. When getting  a directories contents an array of information on each file is returned  which contains the file name, id, permissions and location among other things.</p><p>==== ERRORS ====</p><p>The following map numbers to errors:</p><p>+--------+--------------------------------+  | Number | Error Description              |  +--------+--------------------------------+  |  0     | unknown error                  |  |  1     | read permission failure        |  |  2     | write permission failure       |  |  3     | view permission failure        |  |  4     | invalid path                   |  |  5     | system permission failure      |  |  6     | file/dir already exists        |  +--------+--------------------------------+</p><p>The error function can also be used to get further information on the  last error to occur.</p></p>
	<ul class="tags">
				<li><span class="field">author:</span> Conor Mac Aoidh &lt;<a href="mailto:conormacaoidh@gmail.com">conormacaoidh@gmail.com</a>&gt;</li>
				<li><span class="field">version:</span> 1.0</li>
				<li><span class="field">todo:</span> return errors in number format instead of boolean for better de-bugging and for language support   also add lastError function or something like that to see errors</li>
				<li><span class="field">license:</span> <a href="http://furasta.org/licence.txt">The BSD License</a></li>
			</ul>
		
			</div>
</div>
		
	<a name="sec-classes"></a>	
	<div class="info-box">
		<div class="info-box-title">Classes</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
			<span class="disabled">Classes</span>
			|																<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<table cellpadding="2" cellspacing="0" class="class-table">
				<tr>
					<th class="class-table-header">Class</th>
					<th class="class-table-header">Description</th>
				</tr>
								<tr>
					<td style="padding-right: 2em; vertical-align: top">
						<a href="../admin_files/FileManager.html">FileManager</a>
					</td>
					<td>
											
										</td>
				</tr>
							</table>
		</div>
	</div>

	
	
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
							<a href="#sec-classes">Classes</a>
				|															<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			<a name="functionaddDir" id="functionaddDir"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">addDir</span> (line <span class="line-number">471</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">addDir</p>
<p class="description"><p>adds a directory to the file manager</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			addDir
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, [<span class="var-type">array</span>&nbsp;<span class="var-name">$perm</span> = <span class="var-default">array( )</span>], [<span class="var-type">bool</span>&nbsp;<span class="var-name">$public</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span>			</li>
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$perm</span>			</li>
					<li>
				<span class="var-type">bool</span>
				<span class="var-name">$public</span>			</li>
				</ul>
		
	
</div>
<a name="functionaddFile" id="functionaddFile"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">addFile</span> (line <span class="line-number">658</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">addFile</p>
<p class="description"><p>creates a file at the given location. returns  false if permission failure</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			addFile
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$contents</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$perm</span> = <span class="var-default">array( )</span>], [<span class="var-type"></span>&nbsp;<span class="var-name">$public</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$contents</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$perm</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$public</span>			</li>
				</ul>
		
	
</div>
<a name="functioncleanUp" id="functioncleanUp"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">cleanUp</span> (line <span class="line-number">843</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">cleanUp</p>
<p class="description"><p>scans the files directory for files which are not in  the database and removes them. it is rare for any files  to be in this directory without being in the database,  with the exception of when a database query fails.</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			cleanUp
		</span>
				()
			</div>

		
	
</div>
<a name="functioncopyFile" id="functioncopyFile"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">copyFile</span> (line <span class="line-number">748</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">copyFile</p>
<p class="description"><p>copys a file from one location to another. returns  an array of new database info on the file</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			copyFile
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$file</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$file</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span>			</li>
				</ul>
		
	
</div>
<a name="functionerror" id="functionerror"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">error</span> (line <span class="line-number">828</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">error</p>
<p class="description"><p>returns information on the last recorded error.  for the form of the array, see the private error  variable</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			error
		</span>
				()
			</div>

		
	
</div>
<a name="functiongetInstance" id="functiongetInstance"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">getInstance</span> (line <span class="line-number">451</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">getInstance</p>
<p class="description"><p>if an instance exists, it returns it,  if not, it creates a new one and returns  it</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">instance</span>
		<span class="method-name">
			getInstance
		</span>
				()
			</div>

		
	
</div>
<a name="functionmoveDir" id="functionmoveDir"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">moveDir</span> (line <span class="line-number">801</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			moveDir
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$path</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$dest</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type"></span>
				<span class="var-name">$path</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$dest</span>			</li>
				</ul>
		
	
</div>
<a name="functionmoveFile" id="functionmoveFile"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">moveFile</span> (line <span class="line-number">708</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">moveFile</p>
<p class="description"><p>moves a file from one location to another  while keeping the database in sync</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			moveFile
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$file</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$file</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span>			</li>
				</ul>
		
	
</div>
<a name="functionmoveUploadedFile" id="functionmoveUploadedFile"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">moveUploadedFile</span> (line <span class="line-number">805</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			moveUploadedFile
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$file</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$path</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type"></span>
				<span class="var-name">$file</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$path</span>			</li>
				</ul>
		
	
</div>
<a name="functionreadDir" id="functionreadDir"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">readDir</span> (line <span class="line-number">577</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">readDir</p>
<p class="description"><p>reads a directory and returns it's contents. if $all  is true then all directory and sub directory contents  are returned. if strict is true then will return false  if permission is denied to read any file</p><p>$level	-	can be an integer of how many levels 			of directories to read or true to read 			all levels. reads one level by default  $strict	-	if strict is true and any files fail to 			be read the method will generate an error 			and return false, otherwise those files 			will just be excluded from the list</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			readDir
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, [<span class="var-type">int/bool</span>&nbsp;<span class="var-name">$level</span> = <span class="var-default">1</span>], [<span class="var-type">bool</span>&nbsp;<span class="var-name">$strict</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span>			</li>
					<li>
				<span class="var-type">int/bool</span>
				<span class="var-name">$level</span>			</li>
					<li>
				<span class="var-type">bool</span>
				<span class="var-name">$strict</span>			</li>
				</ul>
		
	
</div>
<a name="functionreadFile" id="functionreadFile"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">readFile</span> (line <span class="line-number">783</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">readFile</p>
<p class="description"><p>returns the contents of a file</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string/bool</span>
		<span class="method-name">
			readFile
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span>			</li>
				</ul>
		
	
</div>
<a name="functionremoveDir" id="functionremoveDir"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">removeDir</span> (line <span class="line-number">527</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">removeDir</p>
<p class="description"><p>removes a directory, and all of it's contents if  non-empty. must have permission to remove all files in  directory</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			removeDir
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$path</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type"></span>
				<span class="var-name">$path</span>			</li>
				</ul>
		
	
</div>
<a name="functionunzip" id="functionunzip"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">unzip</span> (line <span class="line-number">814</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			unzip
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$zip</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$path</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type"></span>
				<span class="var-name">$zip</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$path</span>			</li>
				</ul>
		
	
</div>
<a name="functionzip" id="functionzip"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">zip</span> (line <span class="line-number">810</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			zip
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$zip</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$path</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type"></span>
				<span class="var-name">$zip</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$path</span>			</li>
				</ul>
		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Thu, 07 Jun 2012 09:52:53 +0100 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.4</a>
	</p>
	</div></body>
</html>